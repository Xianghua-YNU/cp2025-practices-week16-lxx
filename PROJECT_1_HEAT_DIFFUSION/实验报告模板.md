# 项目：铝棒热传导方程显式差分法数值解 - 实验报告

**学生姓名：** 李欣欣

**学号：** 20221180076

**完成日期：** 2025/6/11

## 1. 实验目的

本实验通过实现显式差分法求解一维热传导方程，旨在：
1. 掌握偏微分方程数值解法的基本原理
2. 深入理解显式差分法的稳定性条件和精度特点
3. 学会分析数值方法的误差和稳定性
4. 比较数值解与解析解的差异
5. 研究不同初始条件和边界条件对热传导过程的影响

## 2. 理论背景

### 2.1 热传导方程

一维热传导方程的数学表达式为：

$$\frac{\partial T(x,t)}{\partial t} = \alpha \frac{\partial^2 T(x,t)}{\partial x^2}$$

其中：
- $T(x,t)$ 是温度分布函数
- $\alpha = \frac{K}{C\rho}$ 是热扩散系数
- $K$ 是热导率 (237 W/(m·K))
- $C$ 是比热容 (900 J/(kg·K))
- $\rho$ 是密度 (2700 kg/m³)

计算得热扩散系数 $\alpha \approx 9.753 \times 10^{-5}$ m²/s

### 2.2 边界条件和初始条件

- **边界条件：** $T(0,t) = T(L,t) = 0$ K（两端保持0度）
- **初始条件：** $T(x,0) = 100$ K（初始温度均匀分布）

### 2.3 解析解

该问题的解析解为傅里叶级数：

$$T(x,t) = \sum_{n=1,3,5,\ldots}^{\infty} \frac{4T_0}{n\pi} \sin(k_n x) e^{-k_n^2 \alpha t}$$

其中 $k_n = \frac{n\pi}{L}$， $T_0 = 100$ K。

## 2. 核心算法

### 2.1 显式差分法算法思路

显式差分法（FTCS格式）的基本思想：
1. 空间离散：使用中心差分近似二阶空间导数
   $$\frac{\partial^2 T}{\partial x^2} \approx \frac{T_{i+1}^n - 2T_i^n + T_{i-1}^n}{\Delta x^2}$$
2. 时间离散：使用前向差分近似时间导数
   $$\frac{\partial T}{\partial t} \approx \frac{T_i^{n+1} - T_i^n}{\Delta t}$$
3. 迭代公式：
   $$T_i^{n+1} = T_i^n + r(T_{i+1}^n - 2T_i^n + T_{i-1}^n)$$
   其中 $r = \alpha \Delta t / \Delta x^2$
4. 稳定性条件：$r \leq 0.5$

### 2.2 关键代码片段

```python
# 显式差分法核心实现
def explicit_method():
    r = alpha * dt / dx**2  # 稳定性参数
    u = np.zeros((Nx, Nt))  # 初始化温度场
    u[1:-1, 0] = 100        # 初始条件
    
    # 时间迭代
    for j in range(Nt-1):
        # 空间迭代（内部点）
        for i in range(1, Nx-1):
            u[i, j+1] = u[i,j] + r*(u[i+1,j] - 2*u[i,j] + u[i-1,j])
    
    return u

# 解析解实现
def analytical_solution(n_terms=100):
    u = np.zeros((Nx, Nt))
    x = np.linspace(0, L, Nx)
    
    for n in range(1, n_terms+1, 2):  # 只取奇数项
        kn = n * np.pi / L
        for j in range(Nt):
            t = j * dt
            u[:,j] += (4*100/(n*np.pi)) * np.sin(kn*x) * np.exp(-kn**2 * alpha * t)
    
    return u
```

## 3. 实验结果

### 3.1 显式差分法数值解

![image](https://github.com/user-attachments/assets/8bacc1a6-df20-4ad4-9175-c4d072eba750)

数值解显示温度从初始均匀分布逐渐向两端扩散，最终趋近于0K。温度梯度随时间减小，符合热力学第二定律。

### 3.2 解析解

![image](https://github.com/user-attachments/assets/737feab8-f8f6-47f8-a34b-7acae2af64a5)

解析解与数值解在整体趋势上一致，但在边界附近存在微小差异。解析解需要足够多的傅里叶项(实验中取100项)才能准确描述初始阶跃条件。

### 3.3 稳定性分析

**稳定性条件验证：**
- 稳定情况 ($r=0.4889$):
  
  解平滑收敛，符合物理实际

- 不稳定情况 ($r=0.5867$):
![image](https://github.com/user-attachments/assets/9671f983-0b07-46e7-874e-8147987552d7)

  出现非物理振荡并迅速发散

### 3.4 不同初始条件模拟

![image](https://github.com/user-attachments/assets/cf90b6ab-ed97-4539-9c74-fadef262ed1f)

初始左半100K、右半50K的模拟显示温度在交界处快速平衡，最终仍趋近于0K。不连续的初始条件导致初期较大的温度梯度。

### 3.5 包含牛顿冷却定律的模拟

![image](https://github.com/user-attachments/assets/00096ddc-17c7-4b34-9a02-901d2f9469cd)

与绝热情况相比，温度下降更快。冷却系数h=0.01 s⁻¹时，1000秒后中心温度降至约20K，而绝热情况下约为40K。

## 4. 分析与讨论

### 4.1 稳定性问题

1. **稳定性限制**：显式方法要求 $r \leq 0.5$，这导致时间步长受到严格限制 ($\Delta t \leq \Delta x^2 / 2\alpha$)。对于 $\Delta x = 0.01$ m，最大 $\Delta t \approx 0.512$ s。

2. **不稳定性表现**：当 $r > 0.5$ 时，高频误差分量被放大，导致解振荡发散。这是由于显式方法没有数值耗散来抑制这些误差。

### 4.2 精度问题

1. **空间离散误差**：中心差分引入 $O(\Delta x^2)$ 截断误差。减小 $\Delta x$ 可提高精度但增加计算量。

2. **时间离散误差**：前向差分只有 $O(\Delta t)$ 精度。可采用更高阶方法如Crank-Nicolson格式改进。

3. **初始条件处理**：对于不连续初始条件，傅里叶级数存在Gibbs现象，需要更多项才能准确描述。

## 5. 思考题

### 5.1 理论思考

1. **为什么显式差分法在r > 0.5时会产生数值振荡？**

   从数学角度看，当 $r > 0.5$ 时，差分方程的增长因子大于1，误差被指数放大。从物理角度看，过大的时间步长导致算法无法正确捕捉热量扩散的物理过程，违反了热传导的因果关系。

2. **如何从物理角度理解稳定性条件的含义？**

   稳定性条件 $r \leq 0.5$ 保证了在一个时间步长内，热量不会传播超过一个空间步长。这类似于CFL条件，确保数值依赖域包含物理依赖域。当 $r > 0.5$ 时，数值方法"跳过"了应有的物理过程，导致非物理解。

### 5.2 扩展思考

1. **如何改进算法以提高稳定性？**
   - 采用隐式方法（如Crank-Nicolson）可无条件稳定
   - 使用自适应时间步长策略
   - 考虑高阶空间离散方法

2. **牛顿冷却项对稳定性条件的影响？**
   冷却项引入额外的稳定性条件 $h\Delta t < 1$，但通常比扩散项的限制更宽松。综合稳定性条件为：
   $$r \leq \frac{1}{2}(1 - h\Delta t)$$
